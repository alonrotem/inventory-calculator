<app-modal-dialog #customerDialog>
    <div modalContent>
<form novalidate #bankForm="ngForm" [id]="'bankForm'">
<div class="row spaced-row">
    <div class="col p-field">
        <span class="form-floating">
        <div [ngClass]="{'ng-autocomplete': true, 'invalid': (customerName.touched && customerName.value==='')}">
            <ng-autocomplete 
              [data]="customer_names"
              placeholder="Customer name"
              [itemTemplate]="itemTemplate"
              [(ngModel)]="editedObject.name"
              class="form-control form-control-plaintext abc"
              name="customerName"
              #customerName="ngModel"
              required="true"
              (selected)="customer_name_selected($event)"
              (inputChanged)="customer_name_selected($event)"
              [disabled]="editedObject.id!=0">
            </ng-autocomplete>
            <ng-template #itemTemplate let-item>
                <a [innerHTML]="item"></a>
            </ng-template>
        </div>
        </span>
    </div>
    <div class="text-danger" *ngIf="attemptedClose && customerName.value==''">Please enter a customer name</div>
    <div class="text-success" *ngIf="customerName.value!='' && customer_names.indexOf(customerName.value) == -1">New customer <strong>{{ customerName.value }}</strong> will be created</div>
</div>
<div class="row spaced-row">
    <div class="col-12">
        
            <span style="display: flex; flex-wrap: nowrap; justify-content: flex-start; align-items: center;">
                <div class="form-floating" style="width: 100%; margin-right: 20px;">
                <input type="number" #materialQuantity="ngModel" [ngClass]="{'form-control': true, 'invalid': ((bankForm.touched) && ((editedObject.quantity <=0) || (editedObject.quantity > remainingMaterialQuantity)))}"
                    placeholder="0" [(ngModel)]="editedObject.quantity" name="materialQuantity" required="true" min="1" max="{{ remainingMaterialQuantity }}"> 
                    <label for="materialQuantity">Quantity</label>
                </div>
                <span>{{ editedObject.quantity_units }}</span>
            </span>
        </div>
</div>
<div class="row unspaced-row">
    <div class="col">
        <!--
        validation:
        -->
        <div class="text-danger" *ngIf="(attemptedClose && (materialQuantity.value=='' || materialQuantity.value <= 0) )">
            Please enter a valid quantity
        </div>
        <div class="text-danger" *ngIf="(attemptedClose && (materialQuantity.value!='' && materialQuantity.value > remainingMaterialQuantity) )">
            Not enough raw material quantity (<strong>Max: {{ remainingMaterialQuantity }} {{editedObject.quantity_units }}</strong>)
        </div>
    </div>
</div>
</form>
<div>
    initialBankQuantity: {{initialBankQuantity}}<br/>
    initialBankRemainingQuantity {{ initialBankRemainingQuantity }}<br/>
    remainingMaterialQuantity: {{ remainingMaterialQuantity }}<br/>
    Can't go higher than {{ remainingMaterialQuantity }}, but not lower than {{ initialBankQuantity - initialBankRemainingQuantity }} (in use)
</div>
</div>
</app-modal-dialog>